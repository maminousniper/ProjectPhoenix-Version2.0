import{r as b,l as s,t as B,v as I,C as G,m as h,p as E,G as v,n as H,w as F,x as D,j as k,s as L,B as A,T as P,q as R,y as U,z as O,o as C}from"./index-dafeadfa.js";import{I as q,a as K,C as w}from"./IconSortDescendingLetters-e096bb00.js";import{S as V}from"./Search-a972d158.js";import{S as W}from"./SelectMenu-6299afef.js";import{M as J}from"./ModalMain-d572d4b6.js";import{G as N}from"./Grid-1e8beaee.js";import"./Paper-1e316dd2.js";import"./IconSearch-96976665.js";import"./TextInput-22038d77.js";const Q=({deadline:e,expired:f})=>{const[p,o]=b.useState(""),[n,i]=b.useState(e),l=()=>{e-=1,i(e),o(u(e))},u=a=>{const d=Math.floor(a/3600),j=Math.floor(a%3600/60),r=a%60,g=d<10?`0${d}`:`${d}`,y=j<10?`0${j}`:`${j}`,$=r<10?`0${r}`:`${r}`;return`${g}:${y}:${$}`};return b.useEffect(()=>{const a=setInterval(()=>l(),1e3);return()=>clearInterval(a)},[]),s.jsx("div",{className:"timer",children:n>0?`${p}`:`${f}`})},X="_card_16jo9_1",Y="_imageSection_16jo9_9",Z="_label_16jo9_25",ee="_section_16jo9_43",se="_timer_16jo9_53",te="_icon_16jo9_63",S={card:X,imageSection:Y,label:Z,section:ee,timer:se,icon:te};function ie({data:e,isAdmin:f,handleDelete:p,handleBid:o,dealership:n,lang:i}){var a,d,j;const u=[{label:i.passengers,field:"seats",icon:B},{label:i.speed_unit,field:"speed",icon:I},{label:i.base_price,field:"basePrice",icon:q},{label:i.class,field:"class",icon:K}].map(r=>{var g,y;return s.jsxs(G,{children:[s.jsx(r.icon,{size:"1.05rem",className:S.icon,stroke:1.5}),r.field=="basePrice"&&((g=e==null?void 0:e.extraData)!=null&&g.basePrice)?s.jsx(h,{c:"gray.2",size:"xs",children:`$${((y=e==null?void 0:e.extraData)==null?void 0:y.basePrice).toLocaleString("en-US")} ${r.label}`}):s.jsx(s.Fragment,{children:e.extraData?s.jsx(s.Fragment,{children:e!=null&&e.extraData[r.field]?s.jsx(h,{c:"gray.2",size:"xs",children:`${e==null?void 0:e.extraData[r.field]} ${r.label}`}):s.jsx(h,{c:"gray.2",size:"xs",children:`${r.label} N/A`})}):s.jsx(h,{c:"gray.2",size:"xs",children:`${r.label} N/A`})})]},r.label)});return s.jsx(s.Fragment,{children:s.jsxs(w,{withBorder:!0,radius:"md",className:S.card,bg:"dark.7",children:[s.jsx(w.Section,{children:s.jsx("div",{style:{width:"100%",display:"flex",position:"relative",marginLeft:"auto",backgroundColor:"#101113"},children:s.jsxs(h,{c:"dark.2",fw:500,style:{display:"flex",marginLeft:"auto",marginRight:"auto"},children:["Ends in:Â ",s.jsx(Q,{deadline:e.seconds,expired:i.ending})]})})}),s.jsx(w.Section,{className:S.imageSection,children:s.jsx(E,{src:(a=e==null?void 0:e.extraData)!=null&&a.photo?(d=e==null?void 0:e.extraData)==null?void 0:d.photo:`https://docs.fivem.net/vehicles/${e.model}.webp`,alt:e.name,h:75,p:5,fallbackSrc:"https://i.imgur.com/KzeajsO.png",fit:"scale-down"})}),s.jsxs(v,{justify:"space-between",mt:"md",grow:!0,children:[s.jsx("div",{style:{maxWidth:"60%"},children:s.jsx(H,{label:e.label,color:"dark.8",c:"gray.3",children:s.jsx(h,{c:"gray.2",fw:500,truncate:!0,children:e.label})})}),s.jsx(F,{variant:"outline",color:"cyan.3",style:{width:"30%",textOverflow:"ellipsis"},children:e.category})]}),s.jsxs(w.Section,{className:S.section,mt:"md",children:[s.jsx(h,{fz:"sm",c:"dimmed",className:S.label,children:i.vehicle_info}),s.jsx(v,{gap:8,children:u})]}),s.jsx(w.Section,{className:S.section,children:s.jsxs(v,{gap:5,children:[s.jsxs("div",{style:{width:"50%"},children:[s.jsx(h,{c:"gray.2",fz:"md",fw:700,style:{lineHeight:1},truncate:!0,children:`$${(j=e==null?void 0:e.currentBid)==null?void 0:j.toLocaleString("en-US")}`}),s.jsx(h,{fz:"sm",c:"dimmed",fw:500,style:{lineHeight:1},mt:3,children:i.current_bid})]}),f?s.jsx(D,{radius:"xl",style:{flex:1},color:"red",onClick:()=>{p(e)},children:i.delete}):s.jsx(D,{radius:"xl",style:{flex:1},color:"teal",onClick:()=>{o(e)},disabled:!e.extraData.dealerships.includes(n)||!e.canBid,children:i.place_bid})]})})]})})}const ne=({auctions:e,handleSearch:f,handleCategory:p,isAdmin:o,handleNew:n,lang:i})=>{const{allCategories:l}=k(L);return s.jsxs(A,{bg:"dark.7",h:50,p:10,w:"100%",display:"inline-flex",style:{alignContent:"center",alignItems:"center",borderRadius:"4px"},children:[s.jsxs(v,{gap:"lg",children:[s.jsx(P,{order:3,c:"gray.4",children:`${e} ${i.auctions}`}),s.jsx(W,{data:l,callback:p,placeholder:i.categories,searchable:!0})]}),s.jsxs(A,{style:{display:"flex",justifyContent:"flex-end",float:"right",marginLeft:"auto"},children:[o&&s.jsx(D,{size:"xs",mr:10,color:"cyan",onClick:n,children:i.new_auction}),s.jsx(V,{callback:f})]})]})};const he=()=>{const{lang:e}=k(R),{menuType:f,name:p}=k(L),{allVehicles:o}=k(U),[n,i]=b.useState([]),[l,u]=b.useState(n),[a,d]=b.useState(!1),[j,r]=b.useState({});O("updateSingleAuction",t=>{if(Object.keys(n).find(x=>n[x].identifier===t.identifier)){const x=Object.keys(n).map(_=>n[_].identifier===t.identifier?t:n[_]);i(x)}if(Object.keys(l).find(x=>l[x].identifier===t.identifier)){const x=Object.keys(l).map(_=>l[_].identifier===t.identifier?t:l[_]);u(x)}}),O("updateAuctions",t=>{i(t),u(t)});const g=t=>{const c=Object.values(n).filter(m=>t?m.category.toLowerCase().includes(t.toLowerCase()):!0);u(c)},y=t=>{const c=Object.values(n).filter(m=>t===""?!0:m.label.toLowerCase().includes(t.toLowerCase()));u(c)},$=()=>{const t=Object.keys(o).map(c=>({value:o[c].model,label:`${o[c].label} (${o[c].model})`}));r({title:e.create_auction,options:[{name:"vehicle",title:e.vehicle,type:"select",options:t,searchable:!0,asterisk:!0},{name:"price",icon:"fa-solid fa-tag",title:e.starting_bid,type:"number",asterisk:!0},{name:"time",icon:"fa-regular fa-clock",title:e.ends_in,type:"number",asterisk:!0}],button:e.confirm_button,extraData:{event:"createAuction"}}),d(!0)},z=t=>{var c;(c=t==null?void 0:t.extraData)!=null&&c.event&&C("av_dealership",t.extraData.event,t),d(!1)},M=t=>{if(Object.values(n).find(m=>m.identifier===t.identifier)){const m=Object.values(n).filter(x=>x.identifier!==t.identifier);i(m),u(m)}C("av_dealership","deleteAuction",t.identifier)},T=t=>{r({title:e.place_bid,options:[{name:"amount",icon:"fa-solid fa-circle-dollar-to-slot",title:e.amount,type:"number",asterisk:!0,default:t.currentBid}],button:e.confirm_button,extraData:{event:"bid",vehicle:t,name:p}}),d(!0)};return b.useEffect(()=>{(()=>{C("av_dealership","getAuctions")})()},[]),s.jsxs(s.Fragment,{children:[a&&s.jsx(J,{data:j,callback:z}),s.jsx(ne,{auctions:Object.keys(l).length,handleCategory:g,handleSearch:y,isAdmin:f=="admin",handleNew:$,lang:e}),s.jsx(A,{className:"auction-container",style:{height:window.innerHeight/2.05},children:s.jsx(N,{columns:2,children:Object.keys(l).map((t,c)=>s.jsx(N.Col,{className:"auction-card",children:s.jsx(ie,{data:l[t],isAdmin:f=="admin",handleDelete:M,handleBid:T,dealership:p,lang:e},c)},c))})})]})};export{he as default};
