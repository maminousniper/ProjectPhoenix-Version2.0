import{c as J,d as K,e as X,R as Y,B as Z,M as ee,O as se,Q as te,i as b,k as re,l as e,S as j,m as n,G as f,P as oe,x as k,o as P,j as M,q as ce,s as ne,r as u,w as ae,U as le,V as ie,W as de,C as he}from"./index-dafeadfa.js";import{P as me}from"./Paper-1e316dd2.js";import{M as _,T as ue}from"./TextInput-22038d77.js";import{T as i}from"./Table-e4d8b01e.js";import{I as pe}from"./IconSearch-96976665.js";import{I as fe}from"./IconChevronDown-2f2dc9b5.js";var xe={root:"m-7341320d"};const $=xe;var je=Object.defineProperty,S=Object.getOwnPropertySymbols,L=Object.prototype.hasOwnProperty,U=Object.prototype.propertyIsEnumerable,O=(s,t,r)=>t in s?je(s,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):s[t]=r,B=(s,t)=>{for(var r in t||(t={}))L.call(t,r)&&O(s,r,t[r]);if(S)for(var r of S(t))U.call(t,r)&&O(s,r,t[r]);return s},ye=(s,t)=>{var r={};for(var o in s)L.call(s,o)&&t.indexOf(o)<0&&(r[o]=s[o]);if(s!=null&&S)for(var o of S(s))t.indexOf(o)<0&&U.call(s,o)&&(r[o]=s[o]);return r};const ve={},ge=ee((s,{size:t,radius:r,variant:o,gradient:a,color:l})=>{const p=s.variantColorResolver({color:l||s.primaryColor,theme:s,gradient:a,variant:o||"filled"});return{root:{"--ti-size":se(t,"ti-size"),"--ti-radius":r===void 0?void 0:te(r),"--ti-bg":l||o?p.background:void 0,"--ti-color":l||o?p.color:void 0,"--ti-bd":l||o?p.border:void 0}}}),I=J((s,t)=>{const r=K("ThemeIcon",ve,s),o=r,{classNames:a,className:l,style:p,styles:x,unstyled:h,vars:w}=o,m=ye(o,["classNames","className","style","styles","unstyled","vars"]),z=X({name:"ThemeIcon",classes:$,props:r,className:l,style:p,classNames:a,styles:x,unstyled:h,vars:w,varsResolver:ge});return Y.createElement(Z,B(B({ref:t},z("root")),m))});I.classes=$;I.displayName="@mantine/core/ThemeIcon";var _e=b("chevron-up","IconChevronUp",[["path",{d:"M6 15l6 -6l6 6",key:"svg-0"}]]),Se=b("license","IconLicense",[["path",{d:"M15 21h-9a3 3 0 0 1 -3 -3v-1h10v2a2 2 0 0 0 4 0v-14a2 2 0 1 1 2 2h-2m2 -4h-11a3 3 0 0 0 -3 3v11",key:"svg-0"}],["path",{d:"M9 7l4 0",key:"svg-1"}],["path",{d:"M9 11l4 0",key:"svg-2"}]]),we=b("selector","IconSelector",[["path",{d:"M8 9l4 -4l4 4",key:"svg-0"}],["path",{d:"M16 15l-4 4l-4 -4",key:"svg-1"}]]);function D(s,t){const r=t.toLowerCase().trim();return s.filter(o=>re(s[0]).some(a=>{const l=o[a];return typeof l=="string"?l.toLowerCase().includes(r):!1}))}const R=(s,t)=>{const{sortBy:r}=t;return D(r?[...s].sort((o,a)=>t.reversed?a[r].localeCompare(o[r]):o[r].localeCompare(a[r])):s,t.search)},ze="_th_o6sft_1",Ce="_control_o6sft_9",Te="_icon_o6sft_27",Pe="_header_o6sft_39",be="_scrolled_o6sft_71",g={th:ze,control:Ce,icon:Te,header:Pe,scrolled:be},Ie="_card_lzbe6_1",Ne="_icon_lzbe6_15",ke="_title_lzbe6_27",T={card:Ie,icon:Ne,title:ke};function Me({data:s,lang:t,getVehicleBack:r}){const o=Math.round(s.paid/s.totalPrice*100),a=l=>{P("av_dealership","copy",l)};return e.jsxs(me,{radius:"md",withBorder:!0,className:T.card,mt:20,children:[e.jsx(I,{className:T.icon,size:60,radius:60,color:"cyan",children:e.jsx(Se,{style:{width:j(32),height:j(32)},stroke:1.5})}),e.jsx(n,{ta:"center",fw:700,className:T.title,children:s.vehicle}),e.jsx(n,{c:"dimmed",ta:"center",fz:"sm",children:s.plates}),e.jsxs(f,{justify:"space-between",mt:"xs",children:[e.jsx(n,{fz:"sm",c:"gray.4",fw:500,children:t.total_price}),e.jsx(n,{fz:"sm",c:"gray.4",children:`$${parseFloat(s.totalPrice).toLocaleString("en-US")}`})]}),e.jsxs(f,{justify:"space-between",mt:"xs",children:[e.jsx(n,{fz:"sm",c:"gray.4",fw:500,children:t.paid}),e.jsx(n,{fz:"sm",c:"gray.4",children:`$${parseFloat(s.paid).toLocaleString("en-US")}`})]}),e.jsxs(f,{justify:"space-between",mt:"xs",children:[e.jsx(n,{fz:"sm",c:"gray.4",fw:500,children:t.remaining}),e.jsx(n,{fz:"sm",c:"gray.4",children:`$${(s.totalPrice-s.paid).toLocaleString("en-US")}`})]}),e.jsxs(f,{justify:"space-between",mt:"xs",children:[e.jsx(n,{fz:"sm",c:"gray.4",fw:500,children:t.last_payment}),e.jsx(n,{fz:"sm",c:"gray.4",children:s.lastPayment})]}),e.jsxs(f,{justify:"space-between",mt:"xs",children:[e.jsx(n,{fz:"sm",c:"gray.4",fw:500,children:t.status}),e.jsx(n,{fz:"sm",c:"gray.4",tt:"capitalize",children:s.status})]}),e.jsx(oe,{value:o,mt:"md",color:"cyan"}),e.jsxs(f,{justify:"space-between",mt:"xs",children:[e.jsx(n,{fz:"sm",c:"dimmed",children:`${s.days} / ${s.payments}`}),e.jsxs("div",{style:{alignItems:"center",alignContent:"center"},children:[s.autoRepossess&&e.jsx(k,{color:"red",c:"gray.3",size:"xs",mr:"sm",onClick:()=>{r(s.plates,s.identifier)},children:t.autoRepossess}),e.jsx(k,{color:"cyan",c:"gray.3",size:"xs",onClick:()=>{a(s.phone)},children:t.copy_phone})]})]})]})}const Oe=({data:s,callback:t,lang:r,getVehicleBack:o})=>e.jsx(e.Fragment,{children:e.jsxs(_.Root,{opened:!0,onClose:()=>{t(!1)},size:"lg",radius:5,centered:!0,shadow:"xs",withinPortal:!0,children:[e.jsx(_.Overlay,{}),e.jsx(_.Content,{children:e.jsx(_.Body,{children:e.jsx(Me,{data:s,lang:r,getVehicleBack:o})})})]})});function v({children:s,reversed:t,sorted:r,onSort:o}){const a=r?t?_e:fe:we;return e.jsx(i.Th,{className:g.th,children:e.jsx(de,{onClick:o,className:g.control,children:e.jsxs(f,{justify:"space-between",children:[e.jsx(n,{fw:500,fz:"sm",children:s}),e.jsx(he,{className:g.icon,children:e.jsx(a,{style:{width:j(16),height:j(16)},stroke:1.5})})]})})})}const Ee=()=>{const{lang:s}=M(ce),{name:t}=M(ne),[r,o]=u.useState(""),[a,l]=u.useState([]),[p,x]=u.useState(a),[h,w]=u.useState(null),[m,z]=u.useState(!1),[E,F]=u.useState(!1),[V,C]=u.useState(!1),[q,A]=u.useState({}),y=c=>{const d=c===h?!m:!1;z(d),w(c),x(R(a,{sortBy:c,reversed:d,search:r}))},G=c=>{const{value:d}=c.currentTarget;o(d),x(R(a,{sortBy:h,reversed:m,search:d}))},H=c=>{A(c),C(!0)},Q=async(c,d)=>{C(!1);const N=await P("av_dealership","getVehicleBack",{plates:c,name:t,identifier:d});l(N),x(N)},W=p.map((c,d)=>e.jsxs(i.Tr,{style:{cursor:"pointer"},onClick:()=>{H(c)},children:[e.jsx(i.Td,{children:e.jsx(n,{fz:14,children:c.customer})}),e.jsx(i.Td,{children:c.phone}),e.jsx(i.Td,{children:e.jsx(n,{fz:14,truncate:!0,children:c.vehicle})}),e.jsx(i.Td,{children:c.plates}),e.jsx(i.Td,{children:e.jsx(n,{fz:14,truncate:!0,children:c.sellerName})}),e.jsx(i.Td,{children:e.jsx(ae,{color:c.color,size:"sm",children:c.status})})]},d));return u.useEffect(()=>{(async()=>{const d=await P("av_dealership","getPayments",t);l(d),x(d)})()},[]),e.jsxs(e.Fragment,{children:[V&&e.jsx(Oe,{data:q,callback:C,lang:s,getVehicleBack:Q}),e.jsx(ue,{placeholder:s.search,mb:"md",leftSection:e.jsx(pe,{style:{width:j(16),height:j(16)},stroke:1.5}),value:r,onChange:G,w:"100%"}),e.jsx(le,{style:{position:"absolute"},h:window.innerHeight/2.5,onScrollPositionChange:({y:c})=>F(c!==0),children:e.jsxs(i,{horizontalSpacing:"md",verticalSpacing:"xs",layout:"fixed",striped:!0,highlightOnHover:!0,w:"99%",children:[e.jsx(i.Thead,{className:ie(g.header,{[g.scrolled]:E}),children:e.jsxs(i.Tr,{children:[e.jsx(v,{sorted:h==="customer",reversed:m,onSort:()=>y("customer"),children:s.customer}),e.jsx(i.Th,{children:s.phone}),e.jsx(v,{sorted:h==="vehicle",reversed:m,onSort:()=>y("vehicle"),children:s.vehicle}),e.jsx(v,{sorted:h==="plates",reversed:m,onSort:()=>y("plates"),children:s.plates}),e.jsx(v,{sorted:h==="sellerName",reversed:m,onSort:()=>y("sellerName"),children:s.sellerName}),e.jsx(v,{sorted:h==="status",reversed:m,onSort:()=>y("status"),children:s.status})]})}),e.jsx(i.Tbody,{children:W})]})})]})};export{Ee as default};
