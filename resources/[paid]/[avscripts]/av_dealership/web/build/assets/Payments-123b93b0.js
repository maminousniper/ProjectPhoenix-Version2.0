import{c as X,d as Y,e as Z,R as J,B as K,Q as ee,U as se,V as te,i as P,k as re,l as e,p as ce,W as j,m as n,G as x,P as oe,y as k,o as b,X as _,j as B,t as ne,s as ae,r as u,x as le,Y as ie,Z as de,_ as he,$ as me,C as ue}from"./index-0825e3d8.js";import{T as i}from"./Table-50716821.js";import{I as pe}from"./IconSearch-9811dc67.js";import{I as xe}from"./IconChevronDown-ad88ecf9.js";var fe={root:"m-7341320d"};const M=fe;var je=Object.defineProperty,S=Object.getOwnPropertySymbols,L=Object.prototype.hasOwnProperty,U=Object.prototype.propertyIsEnumerable,D=(s,t,r)=>t in s?je(s,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):s[t]=r,O=(s,t)=>{for(var r in t||(t={}))L.call(t,r)&&D(s,r,t[r]);if(S)for(var r of S(t))U.call(t,r)&&D(s,r,t[r]);return s},ye=(s,t)=>{var r={};for(var c in s)L.call(s,c)&&t.indexOf(c)<0&&(r[c]=s[c]);if(s!=null&&S)for(var c of S(s))t.indexOf(c)<0&&U.call(s,c)&&(r[c]=s[c]);return r};const ve={},ge=ee((s,{size:t,radius:r,variant:c,gradient:a,color:l})=>{const p=s.variantColorResolver({color:l||s.primaryColor,theme:s,gradient:a,variant:c||"filled"});return{root:{"--ti-size":se(t,"ti-size"),"--ti-radius":r===void 0?void 0:te(r),"--ti-bg":l||c?p.background:void 0,"--ti-color":l||c?p.color:void 0,"--ti-bd":l||c?p.border:void 0}}}),I=X((s,t)=>{const r=Y("ThemeIcon",ve,s),c=r,{classNames:a,className:l,style:p,styles:f,unstyled:h,vars:w}=c,m=ye(c,["classNames","className","style","styles","unstyled","vars"]),z=Z({name:"ThemeIcon",classes:M,props:r,className:l,style:p,classNames:a,styles:f,unstyled:h,vars:w,varsResolver:ge});return J.createElement(K,O(O({ref:t},z("root")),m))});I.classes=M;I.displayName="@mantine/core/ThemeIcon";var _e=P("chevron-up","IconChevronUp",[["path",{d:"M6 15l6 -6l6 6",key:"svg-0"}]]),Se=P("license","IconLicense",[["path",{d:"M15 21h-9a3 3 0 0 1 -3 -3v-1h10v2a2 2 0 0 0 4 0v-14a2 2 0 1 1 2 2h-2m2 -4h-11a3 3 0 0 0 -3 3v11",key:"svg-0"}],["path",{d:"M9 7l4 0",key:"svg-1"}],["path",{d:"M9 11l4 0",key:"svg-2"}]]),we=P("selector","IconSelector",[["path",{d:"M8 9l4 -4l4 4",key:"svg-0"}],["path",{d:"M16 15l-4 4l-4 -4",key:"svg-1"}]]);function R(s,t){const r=t.toLowerCase().trim();return s.filter(c=>re(s[0]).some(a=>{const l=c[a];return typeof l=="string"?l.toLowerCase().includes(r):!1}))}const $=(s,t)=>{const{sortBy:r}=t;return R(r?[...s].sort((c,a)=>t.reversed?a[r].localeCompare(c[r]):c[r].localeCompare(a[r])):s,t.search)},ze="_th_o6sft_1",Ce="_control_o6sft_9",Te="_icon_o6sft_27",be="_header_o6sft_39",Pe="_scrolled_o6sft_71",g={th:ze,control:Ce,icon:Te,header:be,scrolled:Pe},Ie="_card_lzbe6_1",Ne="_icon_lzbe6_15",ke="_title_lzbe6_27",T={card:Ie,icon:Ne,title:ke};function Be({data:s,lang:t,getVehicleBack:r}){const c=Math.round(s.paid/s.totalPrice*100),a=l=>{b("av_dealership","copy",l)};return e.jsxs(ce,{radius:"md",withBorder:!0,className:T.card,mt:20,children:[e.jsx(I,{className:T.icon,size:60,radius:60,color:"cyan",children:e.jsx(Se,{style:{width:j(32),height:j(32)},stroke:1.5})}),e.jsx(n,{ta:"center",fw:700,className:T.title,children:s.vehicle}),e.jsx(n,{c:"dimmed",ta:"center",fz:"sm",children:s.plates}),e.jsxs(x,{justify:"space-between",mt:"xs",children:[e.jsx(n,{fz:"sm",c:"gray.4",fw:500,children:t.total_price}),e.jsx(n,{fz:"sm",c:"gray.4",children:`$${parseFloat(s.totalPrice).toLocaleString("en-US")}`})]}),e.jsxs(x,{justify:"space-between",mt:"xs",children:[e.jsx(n,{fz:"sm",c:"gray.4",fw:500,children:t.paid}),e.jsx(n,{fz:"sm",c:"gray.4",children:`$${parseFloat(s.paid).toLocaleString("en-US")}`})]}),e.jsxs(x,{justify:"space-between",mt:"xs",children:[e.jsx(n,{fz:"sm",c:"gray.4",fw:500,children:t.remaining}),e.jsx(n,{fz:"sm",c:"gray.4",children:`$${(s.totalPrice-s.paid).toLocaleString("en-US")}`})]}),e.jsxs(x,{justify:"space-between",mt:"xs",children:[e.jsx(n,{fz:"sm",c:"gray.4",fw:500,children:t.last_payment}),e.jsx(n,{fz:"sm",c:"gray.4",children:s.lastPayment})]}),e.jsxs(x,{justify:"space-between",mt:"xs",children:[e.jsx(n,{fz:"sm",c:"gray.4",fw:500,children:t.status}),e.jsx(n,{fz:"sm",c:"gray.4",tt:"capitalize",children:s.status})]}),e.jsx(oe,{value:c,mt:"md",color:"cyan"}),e.jsxs(x,{justify:"space-between",mt:"xs",children:[e.jsx(n,{fz:"sm",c:"dimmed",children:`${s.days} / ${s.payments}`}),e.jsxs("div",{style:{alignItems:"center",alignContent:"center"},children:[s.autoRepossess&&e.jsx(k,{color:"red",c:"gray.3",size:"xs",mr:"sm",onClick:()=>{r(s.plates,s.identifier)},children:t.autoRepossess}),e.jsx(k,{color:"cyan",c:"gray.3",size:"xs",onClick:()=>{a(s.phone)},children:t.copy_phone})]})]})]})}const De=({data:s,callback:t,lang:r,getVehicleBack:c})=>e.jsx(e.Fragment,{children:e.jsxs(_.Root,{opened:!0,onClose:()=>{t(!1)},size:"lg",radius:5,centered:!0,shadow:"xs",withinPortal:!0,children:[e.jsx(_.Overlay,{}),e.jsx(_.Content,{children:e.jsx(_.Body,{children:e.jsx(Be,{data:s,lang:r,getVehicleBack:c})})})]})});function v({children:s,reversed:t,sorted:r,onSort:c}){const a=r?t?_e:xe:we;return e.jsx(i.Th,{className:g.th,children:e.jsx(me,{onClick:c,className:g.control,children:e.jsxs(x,{justify:"space-between",children:[e.jsx(n,{fw:500,fz:"sm",children:s}),e.jsx(ue,{className:g.icon,children:e.jsx(a,{style:{width:j(16),height:j(16)},stroke:1.5})})]})})})}const Le=()=>{const{lang:s}=B(ne),{name:t}=B(ae),[r,c]=u.useState(""),[a,l]=u.useState([]),[p,f]=u.useState(a),[h,w]=u.useState(null),[m,z]=u.useState(!1),[E,F]=u.useState(!1),[V,C]=u.useState(!1),[A,G]=u.useState({}),y=o=>{const d=o===h?!m:!1;z(d),w(o),f($(a,{sortBy:o,reversed:d,search:r}))},H=o=>{const{value:d}=o.currentTarget;c(d),f($(a,{sortBy:h,reversed:m,search:d}))},q=o=>{G(o),C(!0)},Q=async(o,d)=>{C(!1);const N=await b("av_dealership","getVehicleBack",{plates:o,name:t,identifier:d});l(N),f(N)},W=p.map((o,d)=>e.jsxs(i.Tr,{style:{cursor:"pointer"},onClick:()=>{q(o)},children:[e.jsx(i.Td,{children:e.jsx(n,{fz:14,children:o.customer})}),e.jsx(i.Td,{children:o.phone}),e.jsx(i.Td,{children:e.jsx(n,{fz:14,truncate:!0,children:o.vehicle})}),e.jsx(i.Td,{children:o.plates}),e.jsx(i.Td,{children:e.jsx(n,{fz:14,truncate:!0,children:o.sellerName})}),e.jsx(i.Td,{children:e.jsx(le,{color:o.color,size:"sm",children:o.status})})]},d));return u.useEffect(()=>{(async()=>{const d=await b("av_dealership","getPayments",t);l(d),f(d)})()},[]),e.jsxs(e.Fragment,{children:[V&&e.jsx(De,{data:A,callback:C,lang:s,getVehicleBack:Q}),e.jsx(ie,{placeholder:s.search,mb:"md",leftSection:e.jsx(pe,{style:{width:j(16),height:j(16)},stroke:1.5}),value:r,onChange:H,w:"100%"}),e.jsx(de,{style:{position:"absolute"},h:window.innerHeight/2.5,onScrollPositionChange:({y:o})=>F(o!==0),children:e.jsxs(i,{horizontalSpacing:"md",verticalSpacing:"xs",layout:"fixed",striped:!0,highlightOnHover:!0,w:"99%",children:[e.jsx(i.Thead,{className:he(g.header,{[g.scrolled]:E}),children:e.jsxs(i.Tr,{children:[e.jsx(v,{sorted:h==="customer",reversed:m,onSort:()=>y("customer"),children:s.customer}),e.jsx(i.Th,{children:s.phone}),e.jsx(v,{sorted:h==="vehicle",reversed:m,onSort:()=>y("vehicle"),children:s.vehicle}),e.jsx(v,{sorted:h==="plates",reversed:m,onSort:()=>y("plates"),children:s.plates}),e.jsx(v,{sorted:h==="sellerName",reversed:m,onSort:()=>y("sellerName"),children:s.sellerName}),e.jsx(v,{sorted:h==="status",reversed:m,onSort:()=>y("status"),children:s.status})]})}),e.jsx(i.Tbody,{children:W})]})})]})};export{Le as default};
